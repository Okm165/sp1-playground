#![no_main]
sp1_zkvm::entrypoint!(main);

use sp1_zkvm::lib::bls12381::Bls12381AffinePoint;
use sp1_zkvm::lib::utils::AffinePoint;

#[sp1_derive::cycle_tracker]
pub fn main() {
    for _ in 0..4 {
        // generator.
        // 3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507
        // 1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569
        let a: [u32; 24] = [
            3676489403, 4214943754, 4185529071, 1817569343, 387689560, 2706258495, 2541009157,
            3278408783, 1336519695, 647324556, 832034708, 401724327, 1187375073, 212476713,
            2726857444, 3493644100, 738505709, 14358731, 3587181302, 4243972245, 1948093156,
            2694721773, 3819610353, 146011265,
        ];

        let mut a_point = Bls12381AffinePoint::new(a);

        // scalar.
        // 3
        let scalar: [u32; 12] = [3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

        println!("cycle-tracker-start: bn254_mul");
        a_point.mul_assign(&scalar).unwrap();
        println!("cycle-tracker-end: bn254_mul");

        // 3 * generator.
        // 1527649530533633684281386512094328299672026648504329745640827351945739272160755686119065091946435084697047221031460
        // 487897572011753812113448064805964756454529228648704488481988876974355015977479905373670519228592356747638779818193
        let c: [u32; 24] = [
            38687268, 2530394313, 748820379, 2171894283, 861618169, 4084730449, 2615780849,
            2970801695, 3970537111, 392503597, 4191285267, 166519560, 2427334865, 2739354373,
            1665856604, 3880068460, 265567206, 2644256561, 2881685887, 2795113693, 2311452684,
            2323931699, 2801119391, 53182675,
        ];

        assert_eq!(a_point.0, c);
    }

    println!("done");
}
